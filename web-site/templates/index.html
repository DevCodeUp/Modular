<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>ERP Inteligente</title>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
</head>

<body>

  <header>
    <h1>ERP Inteligente para Fábricas</h1>
    <p>Automatización y análisis avanzado para mejorar tu producción</p>

    <button id="loginButton">Iniciar Sesión</button>

    <!-- Menú flotante -->
    <nav id="navbar">
      <ul id="nav-list">
        <li><a href="{{ url_for('main.index') }}" class="nav-button protected">Inicio</a></li>
        <li>
          <a href="#" class="nav-button protected">Producto</a>
          <ul class="submenu">
            <li><a href="#materia-prima" class="protected">Materia prima</a></li>
            <li><a href="#producto-terminado" class="protected">Producto terminado</a></li>
            <li><a href="#plan-produccion" class="protected">Plan de producción</a></li>
          </ul>
        </li>
        <li><a href="#rendimiento" class="nav-button protected">Rendimiento</a></li>
        <li><a href="#eficiencia" class="nav-button protected">Eficiencia</a></li>
        <li><a href="#tiempos" class="nav-button protected">Tiempos de Producción</a></li>
        <li><a href="#ia" class="nav-button protected">IA</a></li>
        <li><a href="{{ url_for('main.config') }}" class="nav-button protected">Configuración</a></li>
      </ul>
    </nav>
  </header>

  <!-- Modal de Login -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeModal">&times;</span>
      <h2>Iniciar Sesión o Registrarse</h2>
      <form id="loginForm">
        <label for="username">Usuario</label>
        <input type="text" id="username" required>
        <label for="password">Contraseña</label>
        <input type="password" id="password" required>
        <button type="submit">Iniciar Sesión</button>
      </form>
      <p>¿No tienes cuenta? <a href="#">Regístrate aquí</a></p>
    </div>
  </div>

  <section class="content">
    <div class="content-section" id="rendimiento">
      <h3>Rendimiento</h3>
      <p>Monitorización de la productividad y análisis de cuellos de botella.</p>
      <canvas id="chartRendimiento"></canvas>
    </div>
    
    <div class="content-section" id="eficiencia">
      <h3>Eficiencia de Producción</h3>
      <p>Comparación de productos terminados y defectuosos.</p>
      <canvas id="chartEficiencia"></canvas>
    </div>
    
    <div class="content-section" id="tiempos">
      <h3>Tiempo Promedio por Máquina</h3>
      <p>Análisis del tiempo de producción por máquina.</p>
      <canvas id="chartTiempos"></canvas>
    </div>
  </section>

  <footer>
    <p>ERP Inteligente - Soluciones avanzadas para la industria. &copy; 2024</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="{{ url_for('static', filename='js/index.js') }}"></script>
  <script src="{{ url_for('static', filename='js/login.js') }}"></script>
  <script>
    // Verificación de sesión
    let isAuthenticated = false;

    document.querySelectorAll('.protected').forEach(button => {
      button.addEventListener('click', function(e) {
        if (!isAuthenticated) {
          e.preventDefault();
          alert('Debes iniciar sesión para acceder a esta sección.');
        }
      });
    });

    // Mostrar el modal de inicio de sesión
    document.getElementById('loginButton').onclick = function() {
      document.getElementById('loginModal').style.display = 'block';
    };

    document.getElementById('closeModal').onclick = function() {
      document.getElementById('loginModal').style.display = 'none';
    };

    window.onclick = function(event) {
      if (event.target === document.getElementById('loginModal')) {
        document.getElementById('loginModal').style.display = 'none';
      }
    };

    // Simulación de inicio de sesión
    document.getElementById('loginForm').onsubmit = function(e) {
      e.preventDefault();
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      if (username && password) {
        isAuthenticated = true;
        alert('Inicio de sesión exitoso');
        document.getElementById('loginModal').style.display = 'none';
      } else {
        alert('Por favor, ingresa credenciales válidas.');
      }
    };
  </script>
</body>

</html>
